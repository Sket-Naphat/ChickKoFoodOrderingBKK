<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Firebase</title>
</head>
<body>
    <h1>Debug Firebase Connection</h1>
    <div id="debug-output"></div>
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Your JavaScript -->
    <script type="module">
        import { db } from './public/assets/js/firebaseConfig.js';
        import { collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";
        
        console.log("DB object:", db);
        
        // Test basic query
        async function testQuery() {
            try {
                const today = new Date().toISOString().split('T')[0];
                console.log("Testing with date:", today);
                
                const orderCollectionRef = collection(db, "orders");
                const ordersQuery = query(orderCollectionRef, where("orderDate", "==", today));
                
                console.log("Query created successfully");
                
                const snapshot = await getDocs(ordersQuery);
                console.log("Query executed successfully, docs count:", snapshot.size);
                
                document.getElementById('debug-output').innerHTML = `
                    <p>✅ Firebase connection working!</p>
                    <p>Query date: ${today}</p>
                    <p>Documents found: ${snapshot.size}</p>
                `;
                
            } catch (error) {
                console.error("Error:", error);
                document.getElementById('debug-output').innerHTML = `
                    <p>❌ Error: ${error.message}</p>
                `;
            }
        }
        
        // Run test when page loads
        window.addEventListener('load', testQuery);
    </script>
</body>
</html>
